<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: d3 | Mountain Doodles]]></title>
  <link href="http://doodles.mountainmath.ca/blog/categories/d3/feed.atom" rel="self"/>
  <link href="http://doodles.mountainmath.ca/"/>
  <updated>2015-04-02T21:55:16-07:00</updated>
  <id>http://doodles.mountainmath.ca/</id>
  <author>
    <name><![CDATA[MountainMath]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Vancouver Bike Paths]]></title>
    <link href="http://doodles.mountainmath.ca/blog/2015/04/01/bike-paths/"/>
    <updated>2015-04-01T16:24:34-07:00</updated>
    <id>http://doodles.mountainmath.ca/blog/2015/04/01/bike-paths</id>
    <content type="html"><![CDATA[<p>Motivated by the excellent <a href="http://www.washingtonpost.com/blogs/wonkblog/wp/2015/04/01/bleak-maps-of-how-cities-look-using-only-their-bike-lanes/">Washington Post Wonkblog</a> I
mapped Vancouver&rsquo;s bike infrastructure. Looks good at first, but when you take out the &lsquo;fake&rsquo; &ldquo;Local Street&rdquo; bikeways more in line with Wonkblog&rsquo;s methodology it&rsquo;s looking pretty
bleak in large portions of the city.</p>

<p>Of course the devil is in the details and infrastructure cannot just be judged by how it&rsquo;s labeled. If one were to look for 8-80 infrastructure, then the separated lanes
would make the cut. Some of the bike lanes would be marginal, but most would probably make the cut. Although I can&rsquo;t say that I would be particularly keen to let an 8yo cycle on
some of them.</p>

<p>Vancouver&rsquo;s &ldquo;Shared Lanes&rdquo; are not for the faint of heart. They have 50 speed limits on multi-lane roadways
and feature sharrows to make it a little easier for cyclists to &lsquo;take the lane&rsquo;. In some cases cyclists share a lane with
the buses, which is a little better.</p>

<p>The local streets are mostly car tunnels like the &lsquo;Off-Broadway&rsquo; and won&rsquo;t qualify as 8-80, but there are some exceptions like
the local street portion of Pt. Grey Rd, where cycling is rather pleasant.</p>

<iframe src="http://doodles.mountainmath.ca/bike_paths.html" width="100%" height="580"></iframe>


<p><a href="/bike_paths.html">Full screen view</a></p>

<p>Methodology is simple, it&rsquo;s just the city&rsquo;s bike path data from <a href="http://vancouver.ca/your-government/open-data-catalogue.aspx">their open data catalogue</a>. The data
comes with two fields, &lsquo;name&rsquo; and &lsquo;type&rsquo;. The &lsquo;type&rsquo; was used for the checkboxes at the bottom to selectively turn different
bike lane types on or off and the &lsquo;name&rsquo; will be displayed on hover.</p>

<h3>Update</h3>

<h4>Some more Canadian cities:</h4>

<p><a href="http://doodles.mountainmath.ca/bike_paths?city=Calgary&amp;type=BICYCLE_CL&amp;dataUrl=http://doodles.mountainmath.ca/data/CALGIS_TRAN_BIKEWAY.geojson">Calgary</a>,
<a href="http://doodles.mountainmath.ca/bike_paths?city=Victoria&amp;type=FullDescr&amp;dataUrl=http://doodles.mountainmath.ca/data/VicBikeRoutes.geojson">Victoria</a>,
<a href="http://doodles.mountainmath.ca/bike_paths?city=Montreal&amp;name=PROJET_NOM&amp;dataUrl=http://doodles.mountainmath.ca/data/MontrealBikeRoutes.geojson">Montreal</a>,
<a href="http://doodles.mountainmath.ca/bike_paths?city=Toronto&amp;type=CP_TYPE&amp;dataUrl=http://doodles.mountainmath.ca/data/TorontoBikeRoutes.geojson">Toronto</a>
<a href="http://doodles.mountainmath.ca/bike_paths?city=Portland&amp;type=FACILITYDE&amp;name=SEGMENTNAM&amp;dataUrl=http://doodles.mountainmath.ca/data/PDXBikeRoutes.geojson">Portland</a>
<a href="http://doodles.mountainmath.ca/bike_paths?city=NYC&amp;type=TF_Facilit&amp;name=Street&amp;fh=65&amp;dataUrl=http://doodles.mountainmath.ca/data/NYCBikeRoutes.geojson">NYC</a></p>

<p>Want to map another city&rsquo;s data? No problem, just read on.</p>

<!-- more -->


<ol>
<li>Locate the city&rsquo;s bikeway data and download it.</li>
<li>Convert the data to geojson, with coordinates in latitude and longitude.</li>
<li>Put the geojson file online somewhere, e.g. your public dropbox folder.</li>
<li>Optionally look at the geojson file for a bikeway type descriptor and bikeway name, if available.</li>
<li>Build a url for your map by using [<a href="http://doodles.mountainmath.ca/bike_paths">http://doodles.mountainmath.ca/bike_paths</a>] as a base url and add query strings

<ul>
<li><code>city=&lt;city name&gt;</code></li>
<li>optionally <code>type=&lt;bikeway type property&gt;</code></li>
<li>optionally <code>name=&lt;bikeway name property&gt;</code></li>
<li>optionally <code>zoom=true</code> if you want to be able to zoom and pan on the map</li>
</ul>
</li>
</ol>


<p>For example, to map Calgary&rsquo;s bike network you need to <a href="https://data.calgary.ca/opendata/Pages/DatasetListingAlphabetical.aspx#C">got to their open data website</a> and
download the Tranportation Bikeways shapefiles (SHP). To convert them go geojson using <code>ogr2ogr</code></p>

<pre><code>ogr2ogr -f GeoJSON -simplify 1 -s_srs CALGIS_TRAN_BIKEWAY.prj -t_srs "EPSG:4326" CALGIS_TRAN_BIKEWAY.geojson CALGIS_TRAN_BIKEWAY.shp
</code></pre>

<p>from the <a href="http://trac.osgeo.org/gdal/wiki/DownloadingGdalBinaries">GDAL package</a>.</p>

<p>I uploaded the geojson to <code>http://doodles.mountainmath.ca/data/CALGIS_TRAN_BIKEWAY.geojson</code>, so that will be the value of the <code>dataUrl</code> query string.</p>

<p>Looking at the resulting geojson file you will see that the data does not include bikeway names, but it does include
types and the property is called <code>BICYCLE_CL</code>.</p>

<p>The rather lengthy link to the map would then be
<a href="http://doodles.mountainmath.ca/bike_paths?city=Calgary&amp;type=BICYCLE_CL&amp;dataUrl=http://doodles.mountainmath.ca/data/CALGIS_TRAN_BIKEWAY.geojson">http://doodles.mountainmath.ca/bike_paths?city=Calgary&amp;type=BICYCLE_CL&amp;dataUrl=http://doodles.mountainmath.ca/data/CALGIS_TRAN_BIKEWAY.geojson</a></p>

<iframe src="http://doodles.mountainmath.ca/bike_paths?city=Calgary&type=BICYCLE_CL&dataUrl=http://doodles.mountainmath.ca/data/CALGIS_TRAN_BIKEWAY.geojson" width="100%" height="580"></iframe>


<p>Or if you want to zoom into Calgary&rsquo;s sprawling suburbs, you could also enable zooming (using double-click) and panning
<a href="http://doodles.mountainmath.ca/bike_paths?city=Calgary&amp;type=BICYCLE_CL&amp;zoom=true&amp;dataUrl=http://doodles.mountainmath.ca/data/CALGIS_TRAN_BIKEWAY.geojson">http://doodles.mountainmath.ca/bike_paths?city=Calgary&amp;type=BICYCLE_CL&amp;zoom=true&amp;dataUrl=http://doodles.mountainmath.ca/data/CALGIS_TRAN_BIKEWAY.geojson</a></p>

<p>Happy Mapping!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Vancouver Assessment Data]]></title>
    <link href="http://doodles.mountainmath.ca/blog/2015/03/23/vancouver-assessment-data/"/>
    <updated>2015-03-23T16:20:43-07:00</updated>
    <id>http://doodles.mountainmath.ca/blog/2015/03/23/vancouver-assessment-data</id>
    <content type="html"><![CDATA[<p>The City of Vancouver has recently
updated <a href="http://vancouver.ca/your-government/open-data-catalogue.aspx">their open data catalogue</a> with historic tax
data. We figured that would
be a good time to take our previous rather clumsy attempts to map tax data and polish that up a bit.</p>

<p>This time we put in a couple of evenings to build a more responsive map with multiple options of what to map. Head
straight for <a href="http://mountainmath.ca/map/assessment">&lsquo;the map&rsquo;</a> or read on for some background information, including
some methodology on data cleaning and interpolation.</p>

<p><a href="http://mountainmath.ca/map/assessment"><img src="/images/land_value.jpg" alt="&quot;Land Values&quot;" /></a></p>

<!-- more -->


<p>Our previous <a href="/teardown_map.html">&lsquo;teardown map&rsquo;</a> and <a href="/teardown_map.html">&lsquo;high value map&rsquo;</a> suffered from being a static
websites, and they loaded large amounts of data all at once, 30,000 properties for the teardown map, and display
the all at once. Options were limited for displaying more detailed data when selecting individual properties.
For the viewer this resulted more in an exercise of patience than in an &lsquo;interactive&rsquo; experience.</p>

<p>We decided to remedy this by importing the CoV data into a database and chop the data up dynamically and serve it as vector tiles.
For smaller zoom levels we aggregated data at the block level. There are lots of blocks in Vancouver, 4444 that contain
properties with tax information to be precise. So again the map is a little sluggish on mobile devices and slower machines when zoomed out,
but things get much faster as we zoom in.</p>

<p>Moreover, we now have the ability to easily display more detailed information once the use selects an individual
property or block aggregate. We can display a graph with the development of land and building values and other details.
And we integrated google streetview for good measure.</p>

<p>One issue that came up is that CoV historical data has lots of gaps. For example, when a particular property was
re-developed it gets a new tax number. The tax information for the old property is lost and cannot be connected to the
geographic site using the information provided by CoV. So when we display data showing &lsquo;value change&rsquo; between
2006 and 2014 we color these properties in grey. This problem persists when we aggregate information at the block level.
To avoid greying out lots of blocks we extrapolate the missing data by using citywide averages on growth rates
of land and building values for the properties in question. This will likely underestimate the aggregate growth in building
and land value, but will not have a big impact at the block level if the individual property value in question was
comparatively small. But this was not always the case. Better analysis could solve some of these issues, so does
zooming in to the individual property level.</p>

<p>Another issue is that CoV does not provide historic zoning information. It would be interesting to get historic zoning
and development permit information. Some of this data is already available, albeit not in an easily consumable form.</p>

<p>Other than that a big thanks to the folks maintaining the CoV open data catalogue!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Mapping CACs]]></title>
    <link href="http://doodles.mountainmath.ca/blog/2014/11/05/mapping-cacs/"/>
    <updated>2014-11-05T12:03:25-08:00</updated>
    <id>http://doodles.mountainmath.ca/blog/2014/11/05/mapping-cacs</id>
    <content type="html"><![CDATA[<p>After reading the <a href="http://pricetags.wordpress.com/2014/11/04/the-daily-durning-back-and-forth-on-cacs/">post on Price Tags</a>,
originally from <a href="http://karensawatzky.ca/2014/10/29/7868/">Karen Sawatzky&rsquo;s blog</a>, I got curious about getting a
geographic overview over the CACs in Vancouver in 2010, 2011 and 2012.</p>

<p>As opposed to the <a href="/blog/2014/09/05/vancouver-teardown-map/">teardown map</a> the dataset is quite small, so there should
be no problems viewing this on a mobile device. As always, map is below the fold.</p>

<!-- more -->


<p>Some of the property addresses did not match any address in the CoV open data property database, probably because the
developments are quite new and new addresses got assigned. In these cases I mapped the CAC property to a nearby property
and added the &lsquo;Mapped Address&rsquo; field in the info pane. Enjoy.</p>

<iframe src="http://doodles.mountainmath.ca/cac_map.html" width="100%" height="500"></iframe>


<p><a href="/cac_map.html">Full screen view</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Vancouver High Value Improvements Map]]></title>
    <link href="http://doodles.mountainmath.ca/blog/2014/09/07/vancouver-high-value-improvements-map/"/>
    <updated>2014-09-07T22:11:08-07:00</updated>
    <id>http://doodles.mountainmath.ca/blog/2014/09/07/vancouver-high-value-improvements-map</id>
    <content type="html"><![CDATA[<p>After the <a href="/blog/2014/09/05/vancouver-teardown-map/">teardown map</a> that looked at the low end of Vancouver&rsquo;s building
stock, a natural question is to look at the high end. Just as before, we are focusing on the (assessed) value of the
building relative to the total (assessed) value of land and improvements. We defined &ldquo;highly improved&rdquo; properties to
be properties where the ratio is at least 50%, so the building is worth at least as much as the land it is built on.</p>

<p>That&rsquo;s actually a pretty high bar in Vancouver, less than 1500 buildings pass that muster. And in concordance with the
teardown map, the &ldquo;high value improvements&rdquo; seem to concentrate in downtown. See the map below the fold
to explore for yourself.</p>

<!-- more -->


<p>When browsing the map it becomes clear that some properties have &ldquo;high value improvements&rdquo; because of an abnormally low
land value, rather than an abnormally high improvement value. This is probably due to intricacies of zoning in Vancouver
that maybe someone else can shed some light on.</p>

<iframe src="http://doodles.mountainmath.ca/improvement_map.html" width="100%" height="500"></iframe>


<p><a href="/improvement_map.html">Full screen view</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Vancouver Teardown Map]]></title>
    <link href="http://doodles.mountainmath.ca/blog/2014/09/05/vancouver-teardown-map/"/>
    <updated>2014-09-05T13:27:18-07:00</updated>
    <id>http://doodles.mountainmath.ca/blog/2014/09/05/vancouver-teardown-map</id>
    <content type="html"><![CDATA[<p>There has been lots of talk about old homes being torn down and replaced in Vancouver. The likeliest targets are houses
of relatively low value sitting on expensive land. So how many teardown candidates are there in Vancouver, and where
in Vancouver are they located?</p>

<p>To answer this we use data from <a href="http://vancouver.ca/your-government/open-data-catalogue.aspx">Vancouver&rsquo;s open data catalogue</a>
to build an interactive map to explore the low end of the building stock. More specifically, we set a somewhat arbitrary
ratio of (assessed) house value to total (assessed) property value (house + land) of 5% and label everything below that
a &ldquo;teardown candidate&rdquo;.</p>

<p>The short answer is that almost one in three properties in Vancouver fall into this category. And they are distributed
quite evenly across all of Vancouver with some areas like downtown looking a little better.</p>

<!-- more -->


<p>On the level of the individual property the &ldquo;teardown candidate&rdquo; designation might be unfair and somewhat inflammatory.
By our above definition, a million dollar house sitting on a 20 million dollar property is a &ldquo;teardown candidate&rdquo;. In
some cases BC Assessment may have failed to properly account for recent renovations resulting in the building being
undervalued and more likely to show up as a &ldquo;teardown candidate&rdquo;. And of course not every &ldquo;teardown candidate&rdquo; will be
torn down, other options may be preferable. Depending on circumstance extensive renovations may be the better option,
and the pervasiveness of &ldquo;teardown candidates&rdquo; suggest that many people in Vancouver are happy living in a house that
is worth less than 5% of the overall assessed value of the property.</p>

<p>To aid a more individualized look at properties we included the address, the assessed land and improvement values, the
tax levy (CoV just added this information a couple of days ago), zoning information, the land area and the relative land
value. To display this information just hover your mouse over a property (or touch it on your mobile device). Opening a
second browser with a map with satellite imagery (or Apple maps) can provide additional context.</p>

<p>Take a look at the map and explore for yourself. You will need a reasonably fast computer and modern
browser to enjoy the map, it contains lots of data and may feel quite slow on mobile devices.</p>

<iframe src="http://doodles.mountainmath.ca/teardown_map.html" width="100%" height="500"></iframe>


<p><a href="/teardown_map.html">Full screen view</a></p>
]]></content>
  </entry>
  
</feed>
