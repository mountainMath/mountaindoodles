<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: open data | Mountain Doodles]]></title>
  <link href="http://doodles.mountainmath.ca/blog/categories/open-data/feed.atom" rel="self"/>
  <link href="http://doodles.mountainmath.ca/"/>
  <updated>2016-03-03T11:18:56-08:00</updated>
  <id>http://doodles.mountainmath.ca/</id>
  <author>
    <name><![CDATA[MountainMath]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Land Use, Roads (and Parking)]]></title>
    <link href="http://doodles.mountainmath.ca/blog/2016/02/29/land-use/"/>
    <updated>2016-02-29T21:10:05-08:00</updated>
    <id>http://doodles.mountainmath.ca/blog/2016/02/29/land-use</id>
    <content type="html"><![CDATA[<p>The other day at the <a href="https://www.sfu.ca/publicsquare/upcoming-events/city-conversations/2016/Feb-18-2016.html">SFU&rsquo;s City Conversations</a>
someone asked a question about space dedicated to roads, and how that could be unlocked
to aid housing. He mentioned what percentage of space is currently dedicated to roads. I forgot the number,
but I thought to myself that I should look that up for all Metro Vancouver communities. So here we go.</p>

<!-- more -->


<p>Actually, it would be interesting to compare how land is allocated to all kinds of land uses across Metro Vancouver, not just roads.
And with their excellent
<a href="http://doodles.mountainmath.ca/blog/2016/01/31/land-use/">land use dataset</a> it&rsquo;s easy enough to do, justifying spending
two hours on this. <a href="https://mountainmath.ca/land_use/map">Looking at the land use map</a>
one can see that there are some issues with using the dataset for
that purpose, for example the roads within
Stanly Park are missing, as parking lots in Vancouver parks. So this slightly overestimates the green space. But when
added up this won&rsquo;t do much to change the overall area of each land use.</p>

<h3>Land Use Breakdown</h3>

<p>Let&rsquo;s start with a simple chart summing up the land use in each of Metro Vancouver&rsquo;s Municipalities. Just select the one
you are interested in from the dropdown.</p>

<div id="land_use_breakdown" class="land_use"></div>


<p>City of Vancouver stands out as the municipality with the largest proportion of area dedicated to roads right of way.
The right of way includes nature strips, sidewalks, and of course on-street parking.</p>

<h3>Built Area Land Use</h3>

<p>For some of the municipalities large &ldquo;Natural Areas&rdquo; and &ldquo;Undeveloped Area&rdquo; make it difficult to discern the makeup of
the built up areas. So here comes the same graph with some of the large space-cosuming categories taken out.</p>

<div id="land_use_breakdown2" class="land_use"></div>


<p>What&rsquo;s remarkable is that City of Vancouver still is the clear winner in terms of space taken up by roads right of way.</p>

<h3>Roads right of way</h3>

<p>It might be interesting to compute more precisely how the roads right of way is used. But that requires a lot more work.
The City of Vancouver has a dataset with road widths, which would help separate area taken by roads from area taken by
sidewalks and nature strips. One could use google maps to estimate to estimate the amount of space taking up by on-street
parking by sampling a couple of roads and scaling this according to road area. Too much work for me right now, maybe one day I will
have a good enough reason to dedicate some time to this.</p>

<h3>Parking</h3>

<p>Parking in particular is a land use that is artificially inflated. We pay lots of money to buy private property to live
on, and then continue to pay property taxes for that privilege. But we pay nothing to store our vehicles on public roads.</p>

<p>At current land values in Vancouver it just does not make any sense to socialize the cost of parking. A 12m&sup2; on-street
parking space at a low-balled $3000/m&sup2; value is worth $36,000. If we were to price parking at value, rather than
socializing the cost we could have a discussion about using that space more effectively. Killing the parking subsidy
would have a substantial impact on demand (and car ownership), freeing up space to be re-allocated for other uses. For
example for housing by increasing lot sizes and making multi-unit structures more feasible, especally on corner lots.</p>

<div><script src="http://doodles.mountainmath.ca/javascripts/land_use_breakdown.js"></div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[On Condos]]></title>
    <link href="http://doodles.mountainmath.ca/blog/2016/02/10/on-condos/"/>
    <updated>2016-02-10T11:01:47-08:00</updated>
    <id>http://doodles.mountainmath.ca/blog/2016/02/10/on-condos</id>
    <content type="html"><![CDATA[<p>Lots has been said about the upper end of owned dwellings. The movement of the &ldquo;million dollar line&rdquo;, the emergence of
the &ldquo;two million dollar line&rdquo; and &ldquo;multi-million dollar lines&rdquo;. Most of that discussion is focused on
<a href="http://www.mountainmath.ca/map/assessment?filter=sfh" target="_blank">single detached homes</a> or on proxies for &ldquo;single detached&rdquo; like
<a href="http://www.mountainmath.ca/map/assessment?filter=rs" target="_blank">RS zoned properties</a>.</p>

<p>But all of these maps have a clear bias toward the more expensive homes. Everyone knows by now where the most expensive properties
are. But where are the more affordable ones?</p>

<!-- more -->


<p>Before continuing and getting disappointed at the end, we want to highlight the huge limitations when looking for affordable homes.
There is no freely available data on the
floor area or number of bedrooms for each dwelling unit. Next to the price and location (which we have), these are the most
important features of a dwelling. And this limits the usefulness of all that follows.</p>

<p>Why continue? It gives a glimpse of what kind of analysis could be done if the information would be <em>freely</em> available.</p>

<h3>The Elephant in the Room</h3>

<p>In principle all this information is available, <a href="https://twitter.com/bcassessment">BCAssessment</a> has all this data. And they even make it
<a href="http://evaluebc.bcassessment.ca/Default.aspx#">available on their (quite nice) eValue website</a>. But their terms of use
prevent us and others from using this information. Most of the information used in the analysis here originates from BCAssessment,
but it comes via the City of Vancouver that has made the data available through their open data portal.</p>

<p>As I understand it, the main reason why this data is not freely available is that BCAssessment is charged to recover their
own operating cost. So they hold onto their data and try to sell it for cost recovery. In the process of which they harm
the ability of municipalities to plan properly and the public to get a clear idea where things are at and have a fact-based
discussion on how to move forward. Which creates large amounts of friction and may lead to social and economic damages far
exceeding any revenue collected by BCAssessment.</p>

<p>Personally, I don&rsquo;t believe that holding back data is a smart way to run a government. You might want to
<a href="http://twitter.com/home/?status=@bcassessment Please add %23openData license to information you publish on eValue! %23giveUsData" target="_blank">ask BCAssessment to #giveUsData</a>.</p>

<p>For now, let&rsquo;s put the data that we do have to the best use and see what we can tease out.</p>

<h3>Locating the Most Affordable Dwellings</h3>

<p><a href="https://mountainmath.ca/map/special/101" target="_blank"><img  src="http://doodles.mountainmath.ca/images/strata.png" style="width:50%;float:left;margin-right:10px;"></a>
Stating the obvious, the most affordable homes aren&rsquo;t &ldquo;single detached&rdquo;, they are condos. And condos have been largely
absent from the affordability debate, although they make up the majority of owned dwelling units in the City of Vancouver.</p>

<p>Let&rsquo;s start off with a <a href="http://www.mountainmath.ca/map/special/101" target="_blank">map of the roughly 4,500 stratified residential or mixed use properties in Vancouver housing a total of about 10,2000 strata units</a>.
The exact numbers are hard to pin down. (<a href="http://twitter.com/home/?status=@bcassessment Please add %23openData license to information you publish on eValue! %23giveUsData" target="_blank">#giveUsData</a>)</p>

<p>The distribution of stratified units by the total number of strata units
per building gives an idea of the types of strata units that are out there.</p>

<div style="margin:10px 50px;padding:5px;border: 1px solid black;border-radius:5px;">
<div id="graph_strata_by_number" style="height:200px;max-width:640px;" data-url="/data/strata_by_number.json"></div>
<div class="legend no-margin">
  <p><i style="background:steelblue"></i> Number of strata units by size of strata <span style="float:right;margin-right:10px;" id="unit_counts_value"></span></p>
</div>
</div>


<p>The horizontal axis is not linear, and the bin sizes are not equal, which makes the graph a little difficult to read. We chose bins at
2, 4, 8, 10, 16, 20 at the low end, then of width 10 up to 200, from there width 20 up to 300 and then 400, 500 and 700 at
the top end. Lazy me apologizes for the poor graphic.</p>

<p>We immediately notice the 4,152 strata units in stratas with exactly 2 units usually referred to as &ldquo;duplexes&rdquo;.
There are a lot of strata units are in stratas of size between 20 and 50, but
otherwise the units are fairly well distributed over different building sizes. At the high end there are fewer buildings,
but each with lots of units. So there our graph becomes a little jerky and heavily depends on the cutoffs we choose.</p>

<p>To get a basic idea on how much these units cost we plot the number of strata units by price bracket.</p>

<div style="margin:10px 50px;padding:5px;border: 1px solid black;border-radius:5px;">
<div id="graph_strata_by_price" style="height:200px;max-width:640px;" data-url="/data/strata_by_price.json"></div>
<div class="legend no-margin">
  <p><i style="background:steelblue"></i> Number of strata units by price <span style="float:right;margin-right:10px;" id="affordable_value"></span></p>
</div>
</div>


<p>The distribution looks largely as one would expect. It peaks between the $400k and $500k mark, with a median value of
$482,000. But there are a couple of things that jump out. Firstly, there are suspiciously many condos
below $100k, more than half of which (445 to be precise), are less than $50k. There are places where one could by
a condo for that price, but not in Vancouver. These are stratified parking spaces or other amenity spaces.</p>

<p>Next let&rsquo;s focus in on the 8,313 duplex and multi-plex units with 8 or fewer units (in 2,995 buildings) and plot these
separately.</p>

<div style="margin:10px 50px;padding:5px;border: 1px solid black;border-radius:5px;">
<div id="graph_multiplex_by_price" style="height:200px;max-width:640px;" data-url="/data/multiplex.json"></div>
<div class="legend no-margin">
  <p><i style="background:steelblue"></i> Number of multiplex units by price <span style="float:right;margin-right:10px;" id="multiplex_value"></span></p>
</div>
</div>


<p>We see that the price distribution for multiplex units peaks at a higher price between $800k and $900k, but the overall
numbers are quite small when compared to all strata units.</p>

<h3>Affordable Strata Units</h3>

<p>Let&rsquo;s try to understand where the &ldquo;affordable&rdquo; housing stock is, which we take to be units below $500k, or roughly the
bottom half of the distribution. We would like to map the properties containing housing
units for each of our price brackets, but this gets tricky since the dataset does not hold
information which units are parking spaces and which are commercial.</p>

<p>We need to take care of the problem with needing to distinguish parking spaces from housing units. And from commercial units.
(<a href="http://twitter.com/home/?status=@bcassessment Please add %23openData license to information you publish on eValue! %23giveUsData" target="_blank">#giveUsData</a>) So we are left with
using proxies, so let&rsquo;s set a cutoff price so that most units below are parking stalls and most units above are (residential)
units.</p>

<p>Generally, parking spaces should not cost more than $50,000 which is roughly the cost to build underground
parking. Around $40,000 if it&rsquo;s only one level, getting up to $75,000 (or sometimes even more) when having to go down deeper or water becomes an issue. The
fact that some spaces go for significantly less is the result of mandatory parking minimums. Some parking spaces may be worth
more than $100,000 as some people are willing to pay a premium for a convenient spot. That may mean a spot next to the
elevator by the exit ramp, or simply a parking spot in a specific building that is under supplied and trekking across the
street to a spot somewhere else is inconvenient enough. Or some stratified parking spaces might consist of several
parking spots.</p>

<h3>Location of Affordable Condos</h3>

<p><a href="https://mountainmath.ca/map/special/110" target="_blank"><img  src="http://doodles.mountainmath.ca/images/strata_500k.png" style="width:50%;float:left;margin-right:10px;"></a>
Since it is impossible to pick out the housing units out of all the strata units, all we can do is map all strata units,
understanding that
those below $50k are most likely parking spaces, those between $50k and $100k could be parking or housing (or commercial) and the
majority of units above $100k are housing.</p>

<p>And we can&rsquo;t actually map the individual units, only the buildings that house the units. Here are maps of the buildings
housing the units in each of the lower brackets.</p>

<ul>
<li><a href="https://mountainmath.ca/map/special/41" target="_blank">&lt; $100k (715 units in 17 buildings)</a></li>
<li><a href="https://mountainmath.ca/map/special/42" target="_blank">$100k &ndash; $200k (2,415 units in 198 buildings)</a></li>
<li><a href="https://mountainmath.ca/map/special/43" target="_blank">$200k &ndash; $300k (10,270 units in 644 buildings)</a></li>
<li><a href="https://mountainmath.ca/map/special/44" target="_blank">$300k &ndash; $400k (19,128 units in 1,112 buildings)</a></li>
<li><a href="https://mountainmath.ca/map/special/45" target="_blank">$400k &ndash; $500k (20,538 units in 1,219 buildings)</a></li>
</ul>


<p>Clickin into a particular building and hitting the &ldquo;more&rdquo; button will pull up (a slightly cleaned) tax roster where you
can get more information on the units. And if you are really interested in finding out more about a particular one
you can always <a href="http://evaluebc.bcassessment.ca/Default.aspx#">head on over to BCAssessment&rsquo;s eValue website</a> to look up
more of those details that BCAssessment keeps in public view but locked off from systematic public scrutiny.
(<a href="http://twitter.com/home/?status=@bcassessment Please add %23openData license to information you publish on eValue! %23giveUsData" target="_blank">#giveUsData</a>)</p>

<h3>Makeup of Condos</h3>

<p>The built quality of strata units is generally higher, dollar for dollar, than that of single family homes. This should not
come as a surprise as land is very expensive and stata units tend to use land more efficiently. There are only 27 residential
or mixed use strata buildings that classify as <em>teardowns</em>,
<a href="http://doodles.mountainmath.ca/blog/2016/01/18/redevelopment/">with a teardown coefficient below 5%</a>.
And 25 of these are duplexes, one is a 3-plex and one an 8-plex. There are no condos buildings with more than 8 units that
fit our most restrictive definition of <em>teardown</em>.</p>

<p>Next we explore what kind of buildings the affordable units are in by graphing the number of units in several price ranges
per size of the strata building it is in.</p>

<div style="margin:10px 50px;padding:5px;border: 1px solid black;border-radius:5px;">
<div id="graph_affordable_strata_by_number" style="height:200px;max-width:640px;" data-url="/data/affordable_strata_by_number.json"></div>
<div class="legend no-margin">
</div>
</div>


<p>It looks like buildings with 20 to 60 units are quite good at producing affordable units. Partially that&rsquo;s due to their
abundance, but graphing the percentage of units in each price bracket confirms that these buildings tend to produce a
nice mixture of low and high value condos. But larger condo buildings can also achieve this, although the actual performance
of what has been built is mixed. Other factors, for example building age, are likely also at play here.</p>

<div style="margin:10px 50px;padding:5px;border: 1px solid black;border-radius:5px;">
<div id="graph_percentage_affordable_strata_by_number" style="height:200px;max-width:640px;" data-url="/data/percentage_affordable_strata_by_number.json"></div>
<div class="legend no-margin">
</div>
</div>


<p>To see what the distribution of strata units by age is, we use the same price cutoffs and sort the strata units into age
brackets. Since we are mostly interested in the more affordable units we sort out units in buildings with 4 or fewer units.
These units might skew some of the age brackets.</p>

<div style="margin:10px 50px;padding:5px;border: 1px solid black;border-radius:5px;">
<div id="graph_affordable_strata_by_age" style="height:200px;max-width:640px;" data-url="/data/affordable_strata_by_age.json"></div>
<div class="legend no-margin">
</div>
</div>


<p>To highlight the proportional makeup we again and graph this again as percentages.</p>

<div style="margin:10px 50px;padding:5px;border: 1px solid black;border-radius:5px;">
<div id="graph_percentage_affordable_strata_by_age" style="height:200px;max-width:640px;" data-url="/data/percentage_affordable_strata_by_age.json"></div>
<div class="legend no-margin">
</div>
</div>


<p>We see how generally the percentage of more affordable units increases with the age of the building. Newer units generally
tend to be more expensive at first and becoming more affordable over time as the building ages.</p>

<h3>Taking Stock</h3>

<p>If you read this far you probably agree that this exercise was mostly a waste of time. Hopefully you are earger to see this
analysis split up by number of bedrooms and floor area. If you are all riled up at the lack of data and BCAssessment
not giving out this information with a clean open data license you might want to drop them a line and
<a href="http://twitter.com/home/?status=@bcassessment Please add %23openData license to information you publish on eValue! %23giveUsData" target="_blank">ask for at least the information they publish eValue to be made available with an #openData license!</a></p>

<p>I am still hopeful that this might happen some day, and we can get a much better picture of the buildings in BC cities
and check how they perform in fulfilling the needs of the community. And learn from that to make informed policy choices.</p>

<script>

function stacked_bar_graph(div,shiftAxis,domainFormatter,rangeFormatter,domainLabelFormatter){
    if (!domainFormatter) domainFormatter=d3.format("d")
    if (!rangeFormatter)
     rangeFormatter = function (y) {
        return y;
     };
     if (!domainLabelFormatter) domainLabelFormatter=domainFormatter;

var margin = {top: 20, right: 20, bottom: 40, left: 70},
    width = parseInt(div.style("width")) - margin.left - margin.right,
    height = parseInt(div.style("height")) - margin.top - margin.bottom;

var x = d3.scale.ordinal()
    .rangeRoundBands([0, width], .1);

var y = d3.scale.linear()
    .range([height, 0]);


var xAxis = d3.svg.axis()
    .scale(x)
    .tickFormat(domainFormatter)
    .orient("bottom");


var yAxis = d3.svg.axis()
    .scale(y)
    .orient("left")
    .tickFormat(rangeFormatter)
    .ticks(5, rangeFormatter);

var svg = div.append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

var data_url=div[0][0].dataset.url;
var legend=d3.select(div.node().parentNode).select('.legend');


d3.json(data_url, function(error, json) {
  if (error) throw error;
  var graphData=json[0];
  var data=graphData.data;
  var color = d3.scale.ordinal().domain(graphData.colors.map(function(d,i){return i}))
  .range(graphData.colors);
  var domain=data.map(function(d){return d.date;});
  x.domain(domain);

  function graphValueId(i){
      return graphData.class + '_' + i + '_value'
  }

  graphData.labels.forEach(function(text,i){
    var color=graphData.colors[i];
    var html='<i style="background:' + color + '"></i> ' + text + ' <span style="float:right;margin-right:10px;" id="' + graphValueId(i) + '"></span>'
    legend.append('p').html(html);
  });
  
  data.forEach(function(d) {
      var y0 = 0;
      d.values = color.domain().map(function(i) { return {date: d.date, y0: y0, y1: y0 += +d.count[i]}; });
      d.total = d.values[d.values.length - 1].y1;
  });
  y.domain([0, d3.max(data, function(d) { return d.total; })]);

  var domainTickValues=[];
  var skip=Math.round(40/x.rangeBand());
  if (skip<=0) skip=1;
  for (var i=0;i<x.domain().length;i++) {
    if (i % skip==0) domainTickValues.push(x.domain()[i]);
  }
  if (x.domain().length % 5 !=0) domainTickValues.push(x.domain()[x.domain().length-1]);
  xAxis.tickValues(domainTickValues);

  var xShift=shiftAxis ?  x.rangeBand()/2.0 * 1.1 : 0;
  
  svg.append("g")
      .attr("class", "x axis")
      .attr("transform", "translate(" + xShift + "," + height + ")")
      .call(xAxis);

  svg.append("g")
      .attr("class", "y axis")
      .call(yAxis);
//    .append("text")
//      .attr("transform", "rotate(-90)")
//      .attr("y", 6)
//      .attr("dy", ".71em")
//      .style("text-anchor", "end")
//      .text("Probability");

    function updateTooltip(d,i){
       color.domain().forEach(function(j){
             var value=d && i==j ? (domainLabelFormatter(d.date) + ': ' +rangeFormatter(d.y1-d.y0)) : '';
             d3.select('#'+graphValueId(j)).text( value);
       });
    }

  var year=svg.selectAll(".year")
    .data(data)
        .enter().append("g")
          .attr("class", "g");
  year.selectAll(".color-bar")
      .data(function(d) { return d.values; })
    .enter().append("rect")
      .attr("class", graphData.class + " color-bar")
      .attr("fill", graphData.color)
      .attr("x", function(d) { return x(d.date); })
      .attr("width", x.rangeBand())
      .attr("y", function(d) { return y(d.y1); })
      .attr("height", function(d) { return Math.max(0, y(d.y0) - y(d.y1)); })
      .attr("fill",function(d,i) {return color(i);})
      .on('mouseover',updateTooltip)
      .on('click',updateTooltip)
      .on('touch',updateTooltip) 
      .on('mouseout',function(){updateTooltip(null,i)});

      
});

}

function bar_graph(div,shiftAxis,domainFormatter,rangeFormatter,domainLabelFormatter){
    if (!domainFormatter) domainFormatter=d3.format("d")
    if (!rangeFormatter)
     rangeFormatter = function (y) {
        return y;
     };
     if (!domainLabelFormatter) domainLabelFormatter=domainFormatter;

var margin = {top: 20, right: 20, bottom: 40, left: 70},
    width = parseInt(div.style("width")) - margin.left - margin.right,
    height = parseInt(div.style("height")) - margin.top - margin.bottom;

var x = d3.scale.ordinal()
    .rangeRoundBands([0, width], .1);

var y = d3.scale.linear()
    .range([height, 0]);


var xAxis = d3.svg.axis()
    .scale(x)
    .tickFormat(domainFormatter)
    .orient("bottom");


var yAxis = d3.svg.axis()
    .scale(y)
    .orient("left")
    .tickFormat(rangeFormatter)
    .ticks(5, rangeFormatter);

var svg = div.append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

var data_url=div[0][0].dataset.url;

d3.json(data_url, function(error, json) {
  if (error) throw error;
  var graphData=json[0];
  var data=graphData.data;
  x.domain(data.map(function(d) { return d.date }));
  y.domain([0, d3.max(data, function(d) { return d.count; })]);
  
  var domainTickValues=[];
  var skip=Math.round(40/x.rangeBand());
  if (skip<=0) skip=1;
  for (var i=0;i<x.domain().length;i++) {
    if (i % skip==0) domainTickValues.push(x.domain()[i]);
  }
  if (x.domain().length % 5 !=0) domainTickValues.push(x.domain()[x.domain().length-1]);
  xAxis.tickValues(domainTickValues);

  var xShift=shiftAxis ?  x.rangeBand()/2.0 * 1.1 : 0;
  
  svg.append("g")
      .attr("class", "x axis")
      .attr("transform", "translate(" + xShift + "," + height + ")")
      .call(xAxis);

  svg.append("g")
      .attr("class", "y axis")
      .call(yAxis);
//    .append("text")
//      .attr("transform", "rotate(-90)")
//      .attr("y", 6)
//      .attr("dy", ".71em")
//      .style("text-anchor", "end")
//      .text("Probability");

  svg.selectAll(".bar")
      .data(data)
    .enter().append("rect")
      .attr("class", graphData.class + " bar")
      .attr("fill", graphData.color)
      .attr("x", function(d) { return x(d.date); })
      .attr("width", x.rangeBand())
      .attr("y", function(d) { return y(d.count); })
      .attr("height", function(d) { return height - y(d.count); })
      .on('mouseover',function(d){
         d3.select('#'+this.classList[0]+'_value').text(domainLabelFormatter(d.date) + ': ' + rangeFormatter(d.count)) 
      }).on('click',function(d){
       d3.select('#'+this.classList[0]+'_value').text(domainLabelFormatter(d.date) + ': ' + rangeFormatter(d.count)) 
      }).on('touch',function(d){
         d3.select('#'+this.classList[0]+'_value').text(domainLabelFormatter(d.date) + ': ' + rangeFormatter(d.count)) 
      }).on('mouseout',function(){d3.select('#'+this.classList[0]+'_value').text('')});

      
});

}


var priceFormatter2=d3.format("$,");
    var priceFormatter = function (y) {
        return y>=1000000 ? (priceFormatter2(y/1000000) + 'm') : (priceFormatter2(y/1000) + 'k');
    };
    var brackets=[100000,200000,300000,400000,500000,600000,700000,800000,900000,1000000,2000000,10000000,20000000,40000000]

var binFormatter=function(top){
    var bottom=0;
    if (top<=1000000) bottom=top-100000;
    else if (top==2000000) bottom= 1000000;
    else if (top==10000000) bottom= 2000000;
    else if (top=20000000) bottom= 10000000;
    else bottom=20000000;
    return priceFormatter(bottom) + ' - ' + priceFormatter(top);
}
var percentageFormatter=d3.format("%");
var numberFormatter=d3.format(",");
var numberBinFormatter=function(top){
    var     bins=[0,1,2,4,8,10,16,20,30,40,50,60,70,80,90,100,110,120,130,140,150,160,170,180,190,200,300,400,500,700];
    var index=0;
    while (bins[index]<top && index<bins.length) index ++;
    bottom=bins[index-1]+1;
    return (bottom == top) ? numberFormatter(bottom) : numberFormatter(bottom) + ' - ' + numberFormatter(top);
}
var yearFormatter=d3.format();//function(d){return d;};
var yearBinFormatter=function(top){
     var     bins=[1970,1980,1990,1995,2000,2005,2010,2020];
     var index=0;
     while (bins[index]<top && index<bins.length) index ++;
     bottom=bins[index-1]+1;
     return (bottom == top) ? yearFormatter(bottom) : yearFormatter(bottom) + ' - ' + yearFormatter(top);
}
bar_graph(d3.select("#graph_strata_by_price"),true,priceFormatter,null,binFormatter);
bar_graph(d3.select("#graph_multiplex_by_price"),true,priceFormatter,null,binFormatter);
bar_graph(d3.select("#graph_strata_by_number"),true,numberFormatter,null,numberBinFormatter);
stacked_bar_graph(d3.select("#graph_affordable_strata_by_number"),true,numberFormatter,null,numberBinFormatter);
stacked_bar_graph(d3.select("#graph_percentage_affordable_strata_by_number"),true,numberFormatter,percentageFormatter,numberBinFormatter);
stacked_bar_graph(d3.select("#graph_affordable_strata_by_age"),true,yearFormatter,null,yearBinFormatter);
stacked_bar_graph(d3.select("#graph_percentage_affordable_strata_by_age"),true,yearFormatter,percentageFormatter,yearBinFormatter);
</script>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Loss of Character]]></title>
    <link href="http://doodles.mountainmath.ca/blog/2016/02/01/loss-of-character/"/>
    <updated>2016-02-01T11:16:28-08:00</updated>
    <id>http://doodles.mountainmath.ca/blog/2016/02/01/loss-of-character</id>
    <content type="html"><![CDATA[<p>At the heart of the Vancouver affordabiliy crisis is a phrase that comes up again and again. <em>Loss of Character</em>. To effectively
move forward I think it is important to look closely what it means and how it is used.</p>

<p>And what the data can tell us about <em>loss of character</em>.</p>

<!-- more -->


<h3>Loss of Character</h3>

<p>Very broadly interpreted, <em>change of character</em> is how people describe the process when
the environment around them is changing in profound ways. And the neighbourhoods in Vancouver are indeed changing fast.</p>

<p><em>Loss of character</em>, as opposed to <em>change of character</em>, adds a value judgement. It implies that the former &ldquo;character&rdquo;
was preferable to the new one.</p>

<p>I want to highlight two ways in which this change manifests itself in Vancouver: Change in buildings and change in demographics.</p>

<h3>Change in buildings</h3>

<p>There has been a lot of focus on buildings getting torn down and rebuilt. When a city runs out of land to build new housing,
part of the existing stock will get increasingly cannibalized to make space for new buildings. It pays off to try and
understand how this renewal process works.</p>

<p>Let&rsquo;s take a look at the age distribution of Vancouver&rsquo;s single family homes.</p>

<div style="margin:10px 50px;padding:5px;border: 1px solid black;border-radius:5px;">
<div id="graph_sfh" style="height:200px;max-width:640px;" data-url="/data/sfh_age.json"></div>
<div class="legend no-margin"></div>
</div>


<p>We divided the building stock for each age into two groups, one with building value less than 5% of the total property
value, and one with building value greater than 5%. The significance of that number is that historically over the last
10 years, buildings with this precentage below 5% <a href="http://doodles.mountainmath.ca/blog/2016/01/18/redevelopment/">had a 1 in 6 change of being torn down and rebuilt</a>
over a 10 year time frame, with sharply dropping frequency of tear downs of buildings above that threshold. Check the link
for a more detailed analysis.</p>

<p>We interpret this graph as giving us a decent prediction of what part of our building stock will get torn down and rebuilt
in the next 10 years, 1 in 6 of the red is predicted to go.</p>

<p>What&rsquo;s remarkable is that essentially the entire SFH stock built between 1935 and 1965 is at high risk of being torn down,
while the period before that has a much better chance of surviving. This comes out of purely looking at the data, it would
be helpful if people out there that understand
the characteristics of the homes built at different times could shed some light onto why this maybe be the case.</p>

<p>Appreciating some of the economic drivers of this process, we can try to understand how people feel about the process.
There seem to be several different reactions to and thoughts on buildings being torn down
that can be summed up with the words &lsquo;heritage&rsquo;, &lsquo;waste&rsquo; and &lsquo;McMansion&rsquo;.</p>

<h4>Heritage</h4>

<p><a href="https://mountainmath.ca/map/special/11?zoom=13&amp;lat=49.264&amp;lng=-123.1276&amp;layer=4&amp;filter=sfh"><img  src="http://doodles.mountainmath.ca/images/heritage.png" style="width:50%;float:left;margin-right:10px;"></a>
Some feel strongly about &lsquo;heritage homes&rsquo; which typically goes beyond the
<a href="https://mountainmath.ca/map/special/11?zoom=13&amp;lat=49.264&amp;lng=-123.1276&amp;layer=4">City of Vancouver list of heritage sites</a>
or more specifically the <a href="https://mountainmath.ca/map/special/11?zoom=13&amp;lat=49.264&amp;lng=-123.1276&amp;layer=4&amp;filter=sfh">single family houses on that list</a>.
The term is used differently by different people and may be confined to offical heritage sites, or ones that have been
&lsquo;overlooked&rsquo; and should be part of that list, to houses of a certain age or style (&ldquo;cottage homes&rdquo;), to including pretty
much anything old or decent looking like this <a href="http://www.vancouversun.com/business/bulldozer+bait+million+mansion+just+another+vancouver+tear+down/11686111/story.html?__lsa=8524-b4e7">1996 building that made the news recently</a>.
Many of those heritage sites are well kept up, with a teardown coefficient well above 5%. But there are also some in quite desolate
state.</p>

<p>Most people see value in heritage, for this term to be a more usefuly driver in the discussion it would greatly help to
narrow it down.</p>

<h4>Waste</h4>

<p>Another narrative is that of &lsquo;waste&rsquo;, when a house gets sent to the landfill. And waste is an issue everyone
is concerned about, land fill space is limited and the impact of the building industry is huge,
<a href="http://www.bcbusiness.ca/real-estate/disposable-housing-vancouver-home-demolition">as described in this 2011 article</a>.
The City of Vancouver has enacted some rules on <a href="http://vancouver.ca/home-property-development/demolition-permit.aspx">how much of a building needs to be recycled</a>,
but they are very weak. In particular, there are no binding recycling requirements at all for post 1940 houses beyond recycling drywall.
Generally the sentiment seems to be more concerned with the fact that a building is getting
torn down, rather than focused on how to improve the process of salvaging and recycling the old home.</p>

<p>The good news is that most of the teardown activity in Vancouver has been
<a href="http://doodles.mountainmath.ca/blog/2016/01/18/redevelopment/">focusing on low relative building value properties</a>, so
cases like the demolition of <a href="http://www.vancouversun.com/business/bulldozer+bait+million+mansion+just+another+vancouver+tear+down/11686111/story.html?__lsa=8524-b4e7">that 1996 building assessed at $1.9m</a>
are quite rare. That building has a teardown coefficient of 25%, and historically buildings in that range had a 1 in 200
chance of being torn down in a 10 year period.</p>

<p>What&rsquo;s concerning though is that as land values increase, so do the value (dollar amount) of the buildings that move into
the high-risk category of teardown coefficient below 5%.</p>

<h4>McMansion</h4>

<p>The last important word is &lsquo;McMansion&rsquo;, which tackles the question of what the building gets replaced with. Typically
the term &lsquo;McMansion&rsquo; is used for a building whose primary concern is to maximize the allowable footprint.
Economically speaking, this is a rational reaction to the exorbitant land values. Esthetically it can be quite jarring.</p>

<p>This is where the value judgement in &ldquo;<em>loss</em> of character&rdquo; becomes most apparent. While some people feel visually offended
by them, people that buy these properties clearly prefer them over what was there before. Either way, they serve as constant
reminders of the change the neighbourhoods are experiencing.</p>

<h3>Change in Demographics</h3>

<p>Probably more important than the change in buildings is the change in demographics. Vancouver seems to be experiencing
a gentrification process where the traditional financial elite of &lsquo;high income&rsquo; households is priced out of the market by the new
financial elite of &lsquo;high net worth&rsquo; households. That change is dramatic and it has been going on for long enough now to
have left very visible signs in the 2011 Census data.</p>

<p><a href="http://censusmapper.ca/maps/37"><img  src="http://doodles.mountainmath.ca/images/local_affordability.png" style="width:50%;float:right;"></a>
Looking at the <a href="http://censusmapper.ca/maps/37">&lsquo;local affordability&rsquo; in Vancouver</a> in 2011 we see that in many (not all)
neighbourhoods the people that live there could
not afford to buy again (based on their income). What that means is simply that the people moving in will be demographically
very different from the ones living there right now. And yes, this problem is much worse in Vancouver than in other places in
Canada, which can easily be seen by searching and panning in the map.</p>

<p>This problem has likely gotten much worse since, as housing prices continued to climb much more steeply than income since 2011.</p>

<p><a href="http://www.mountainmath.ca/map/assessment?zoom=14&amp;lat=49.253&amp;lng=-123.1244&amp;layer=12"><img  src="http://doodles.mountainmath.ca/images/twiddling_thumbs.png" style="width:50%;float:left;margin-right:10px;"></a>
Another indicator of just how disconnected the property market, especially that of single family homes, is from the
local economy is that the combined rise of land value of all single family homes combined was $24.6bn, more than the entire
population of Vancouver combined income through work, investment (other than housing) or registered retirement income and
government transfer payments during that year. Even considering pre-tax income (although the housing price increase is tax free for all those
living in their house the year before they sell). <a href="http://doodles.mountainmath.ca/blog/2016/01/24/work-vs-twiddling-thumbs/">Read here more details on this</a>
or <a href="http://www.mountainmath.ca/map/assessment?zoom=14&amp;lat=49.253&amp;lng=-123.1244&amp;layer=12">browse through the map</a> to see
just how much each Vancouver homeowner made last year twiddling thumbs and waiting for land values to rise.</p>

<p>So how can people still buy in this market? Except for the rare cases of people with very large salaries to be able to save
large sums for down payments and handle the mortgage payments, those purchases are founded in wealth, not income. Local wealth,
maybe inherited or handed down from parents when they cached out on their home, or money brought in from abroad.</p>

<p>What&rsquo;s clear is that this wealth-based gentrification process is real and rapidly changing the social character of the
neighbourhoods.</p>

<h3>Hard truths</h3>

<ol>
<li>We can&rsquo;t stop teardowns. The economic drivers are too strong. We can do better at designating and preserving heritage
sites and nudging the process in other ways. Naively projecting past data forward
<a href="http://doodles.mountainmath.ca/blog/2016/01/18/redevelopment/">we predict around 8,000 properties will be torn down and rebuilt</a>
in the next 10 years.</li>
<li>Affordable single family homes are a thing of the past. Demand is growing and supply is shrinking, so prices will
remain high and nothing short of Soviet-style interventions can change that.</li>
<li>Housing in many neighbourhoods is now out of reach for working professionals that can&rsquo;t rely on outside financial help
like inheritance or mortgages backed by the assets of their parents.</li>
<li>Foreign money may have played some role in getting us here, but any solution that solely revolves around dealing with
foreign money won&rsquo;t solve the problem. (Someone should run some
custom tabulations through Stats Canada to get a better handle on the signs of foreign money that can be picked up from the basic 2011
Census data.)</li>
</ol>


<h3>Preserving and Restoring Character (my 2c)</h3>

<p>Looking forward, how can the character of the neighbourhoods be preserved or restored? Most of the public discussion
focuses on the how to preserve the build form; the question how to preserve the
social structure of the neighbourhoods receives much less attention.</p>

<p>I don&rsquo;t have a good overview about what ideas are out there, so I won&rsquo;t attempt to summarize them. Usually I try to focus
on data and keep my opinions out of this, but I could not help myself on this one. So here comes my 2c on what should be done.</p>

<h4>Character of Buildings</h4>

<p>For buildings, we need to focus on what&rsquo;s important to
preserve. We need better rules on building waste. And we need to create policies that guide what teardowns will replace.</p>

<h4>Social Character</h4>

<p>To preserve and restore the social character of the neighbourhoods we need to create housing for the types of people that
used to be able to buy in the neighbourhood and are now being pushed out. That is working professionals. Given that single
family houses will remain out of reach, the only way to do that is to allow (low rise) condos in neighbourhoods. I don&rsquo;t know
if that means just upzoning arterials, or creating pockets of low-rise throughout neighbourhoods like it is common in my
<img  src="http://doodles.mountainmath.ca/images/arbutus-33.png" style="width:50%;float:right;">
native Germany. One example of this in Vancouver is the low-rise pocket at Arbutus and 33rd.
That complex, when taken together with all of Quilchena park, still houses roughly 3 times more people per area than the typical
single family housing neighbourhood with the same total area. And it collects the same amount of property taxes
per square metre as the typical single family neighbourhood (without a park) while it is cheaper to service.</p>

<p>Alternatives, like encouraging laneway houses and secondary suites can also increase supply and help ease the housing crunch.
They are great at increasing rental stock. But they don&rsquo;t increase supply fast enough, don&rsquo;t serve the
demand for home ownership and scatter up the green space into lots of tiny yards instead of freeing up space for larger
parks that can be effectively used for kids to play and recreation. Focusing only on towers instead just intensifies the
gentrification process, but there probably are areas where they make sense. There is no doubt that increasing supply
has to be part of the solution, any ideas like <a href="https://pricetags.wordpress.com/2016/01/31/qa-on-the-toughest-topic-in-town/">&lsquo;downzoning&rsquo;</a>
that fail to increase supply are counterproductive in restoring the social character of the neighbourhoods.</p>

<p><a href="http://censusmapper.ca/maps/88?zoom=14&amp;lat=49.2395&amp;lng=-123.1518"><img  src="http://doodles.mountainmath.ca/images/child_household_density.png" style="width:50%;float:left;margin-right:10px;"></a>
If we are concerned about creating space for families the question becomes where to house them. With land limited, let&rsquo;s
map the density of households with children, so the <a href="http://censusmapper.ca/maps/88?zoom=14&amp;lat=49.2395&amp;lng=-123.1518">number of households with children per km&sup2;</a>.
We immediately see that the existing pockets of mid and high-rise are very effective at housing children households. Using
Census data to model presence of children in households on physical housing parameters we see that having 3 or more bedrooms
is the single most determening factor. If accommodating families is a priority, then we need to ensure that all neighbourhoods
have 3 bedroom options, <a href="http://censusmapper.ca/maps/97">which is currently not the case (2011 data)</a>.</p>

<h4>Dealing with a Wealth-based market</h4>

<p>Moving from a housing market supported by income to one supported by wealth, either of domestic or foreign origin, requires
new rules to ensure fairness and preserve the basic social contract that our society is founded on: That everyone starts
out with more or less the same opportunities, and work and grit can lead to social and economic upward mobility.</p>

<p>Wealth, especially foreign wealth, tends to be much more mobile and can decide on short notice to leave Vancouver. This introduces
enormous risks to the local economy, and smart policies are needed to guard against these risks.</p>

<p>In Canada, people don&rsquo;t pay capital gains on their primary residence. That works fine as long as increases
in land value are relatively low, but with current situation where people <a href="http://doodles.mountainmath.ca/blog/2016/01/24/work-vs-twiddling-thumbs/">earn more money sitting on their house than
actually working</a> the idea that income from
work should be taxes and income from twiddling thumbs should not is just ludicrous. Let&rsquo;s tax all capital gains on housing.
We can deduct investments into improvements and can argue about details like indexing taxable gains to inflation. And
let&rsquo;s tax it at a rate that is higher than the one on income or investments in stocks to re-focus housing as being treated
primarily to house people and not as investment.</p>

<p>This train of thought is similar in nature to the
<a href="http://www.theglobeandmail.com/news/british-columbia/bc-professors-call-for-property-surtax-on-vacant-vancouver-housing/article28235302/">Vacant Housing Tax</a>
in that it would have minimal direct impact
on the market (so it in itself won&rsquo;t bring prices down in a meaningful way), but it would generate substantial amounts of revenue
that could be used to provide relief. And the revenue is large enough that, if spent strategically (for example on building
affordable rental), could have a meaningful impact on the overall property market. And restore fairness in a market where
initial captial barriers are so high only the rich can participate.</p>

<p>Next, with the property market driven by wealth (especially for single family houses), while the way we finance
public services is based on income, we need to ask the question if our current taxation system is still adequate. A capital
gains tax on housing is just one part of this, the proposal to tax vacant properties is another. We could strengthen
legislation and enforcement on foreign income, assuming that this is a big enough issue (Give us better data!).
Other options that should get discussed are a higher property transfer tax, progressive property taxes
(possibly discounted against income tax) and other measures that pay more attention to the role of wealth vs income in
the Vancouver property market. This discussion is important, but requires better data to be meaningful and effective.</p>

<h4>Data</h4>

<p>The profound lack of data is a major problem to find effective ways to fix the affordability crisis. Lack of clear data
can provide a convenient excuse for inaction.</p>

<p>But data does not need to be perfect.<br/>
Much can be learned from the data at hand. A good list of data sources and reproducible findings would be a great way
to establish a baseline, build better arguments and keep the discussion focused on the &ldquo;big fish&rdquo;.</p>

<p>Maybe a dedicated github repro could provide a suitable format for this.</p>

<script>

function stacked_bar_graph(div,shiftAxis,domainFormatter,rangeFormatter,domainLabelFormatter){
    if (!domainFormatter) domainFormatter=d3.format("d")
    if (!rangeFormatter)
     rangeFormatter = function (y) {
        return y;
     };
     if (!domainLabelFormatter) domainLabelFormatter=domainFormatter;

var margin = {top: 20, right: 20, bottom: 40, left: 70},
    width = parseInt(div.style("width")) - margin.left - margin.right,
    height = parseInt(div.style("height")) - margin.top - margin.bottom;

var x = d3.scale.ordinal()
    .rangeRoundBands([0, width], .1);

var y = d3.scale.linear()
    .range([height, 0]);


var xAxis = d3.svg.axis()
    .scale(x)
    .tickFormat(domainFormatter)
    .orient("bottom");


var yAxis = d3.svg.axis()
    .scale(y)
    .orient("left")
    .tickFormat(rangeFormatter)
    .ticks(5, rangeFormatter);

var svg = div.append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

var data_url=div[0][0].dataset.url;
var legend=d3.select(div.node().parentNode).select('.legend');


d3.json(data_url, function(error, json) {
  if (error) throw error;
  var graphData=json[0];
  var data=graphData.data;
  var color = d3.scale.ordinal().domain(graphData.colors.map(function(d,i){return i}))
  .range(graphData.colors);
  var domain=data.map(function(d){return d.date;});
  x.domain(domain);

  function graphValueId(i){
      return graphData.class + '_' + i + '_value'
  }

  graphData.labels.forEach(function(text,i){
    var color=graphData.colors[i];
    var html='<i style="background:' + color + '"></i> ' + text + ' <span style="float:right;margin-right:10px;" id="' + graphValueId(i) + '"></span>'
    legend.append('p').html(html);
  });
  
  data.forEach(function(d) {
      var y0 = 0;
      d.values = color.domain().map(function(i) { return {date: d.date, y0: y0, y1: y0 += +d.count[i]}; });
      d.total = d.values[d.values.length - 1].y1;
  });
  y.domain([0, d3.max(data, function(d) { return d.total; })]);

  var domainTickValues=[];
  var skip=Math.round(40/x.rangeBand());
  if (skip<=0) skip=1;
  for (var i=0;i<x.domain().length;i++) {
    if (i % skip==0) domainTickValues.push(x.domain()[i]);
  }
  if (x.domain().length % 5 !=0) domainTickValues.push(x.domain()[x.domain().length-1]);
  xAxis.tickValues(domainTickValues);

  var xShift=shiftAxis ?  x.rangeBand()/2.0 * 1.1 : 0;
  
  svg.append("g")
      .attr("class", "x axis")
      .attr("transform", "translate(" + xShift + "," + height + ")")
      .call(xAxis);

  svg.append("g")
      .attr("class", "y axis")
      .call(yAxis);
//    .append("text")
//      .attr("transform", "rotate(-90)")
//      .attr("y", 6)
//      .attr("dy", ".71em")
//      .style("text-anchor", "end")
//      .text("Probability");

    function updateTooltip(d,i){
       color.domain().forEach(function(j){
             var value=d && i==j ? (domainLabelFormatter(d.date) + ': ' +rangeFormatter(d.y1-d.y0)) : '';
             d3.select('#'+graphValueId(j)).text( value);
       });
    }

  var year=svg.selectAll(".year")
    .data(data)
        .enter().append("g")
          .attr("class", "g");
  year.selectAll(".color-bar")
      .data(function(d) { return d.values; })
    .enter().append("rect")
      .attr("class", graphData.class + " color-bar")
      .attr("fill", graphData.color)
      .attr("x", function(d) { return x(d.date); })
      .attr("width", x.rangeBand())
      .attr("y", function(d) { return y(d.y1); })
      .attr("height", function(d) { return Math.max(0, y(d.y0) - y(d.y1)); })
      .attr("fill",function(d,i) {return color(i);})
      .on('mouseover',updateTooltip)
      .on('click',updateTooltip)
      .on('touch',updateTooltip) 
      .on('mouseout',function(){updateTooltip(null,i)});

      
});

}


var priceFormatter2=d3.format("$,");
    var priceFormatter = function (y) {
        return y>=1000000 ? (priceFormatter2(y/1000000) + 'm') : (priceFormatter2(y/1000) + 'k');
    };
    var brackets=[100000,200000,300000,400000,500000,600000,700000,800000,900000,1000000,2000000,10000000,20000000,40000000]

var binFormatter=function(top){
    var bottom=0;
    if (top<=1000000) bottom=top-100000;
    else if (top==2000000) bottom= 1000000;
    else if (top==10000000) bottom= 2000000;
    else if (top=20000000) bottom= 10000000;
    else bottom=20000000;
    return priceFormatter(bottom) + ' - ' + priceFormatter(top);
}
var numberFormatter=d3.format(",");
var numberBinFormatter=function(top){
    var     bins=[0,1,2,4,8,10,16,20,30,40,50,60,70,80,90,100,110,120,130,140,150,160,170,180,190,200,300,400,500,700];
    var index=0;
    while (bins[index]<top && index<bins.length) index ++;
    bottom=bins[index-1]+1;
    return (bottom == top) ? numberFormatter(bottom) : numberFormatter(bottom) + ' - ' + numberFormatter(top);
}
stacked_bar_graph(d3.select("#graph_sfh"));
</script>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Land Use Data]]></title>
    <link href="http://doodles.mountainmath.ca/blog/2016/01/31/land-use/"/>
    <updated>2016-01-31T10:25:42-08:00</updated>
    <id>http://doodles.mountainmath.ca/blog/2016/01/31/land-use</id>
    <content type="html"><![CDATA[<p><a href="https://mountainmath.ca/land_use/map"><img  src="http://doodles.mountainmath.ca/images/land use.png" style="width:50%;float:left;margin-right:10px;"></a>
Metro Vancouver has a <a href="http://www.metrovancouver.org/data">fairly good land use dataset</a> that I imported quite some time
ago so that <a href="https://mountainmath.ca/land_use/map">I could take a good look at it</a>. But then I forgot about it until
<a href="https://twitter.com/HealthyCityMaps">@HealthyCityMaps</a> <a href="https://twitter.com/HealthyCityMaps/status/692832946714050564">reminded me</a> just
at the time when the discussions about <a href="https://mountainmath.ca/map/assessment">assessmened values</a> in Vancouver were flaring up again.</p>

<p>So finally I decided to mark up the City of Vancouver assessment dataset with the land use from the Metro Vancouver land
use dataset. And I used the occasion to update my color schemes from two years ago and gave it a dark background that
works better with the <a href="http://colorbrewer2.org">colorbrewer</a> palettes.</p>

<p>The result of the land use and assessment data mashup is a much better understanding what kind of properties we have right now in Vancouver.</p>

<!-- more -->


<h3>Land Use for Assessment Data</h3>

<p>There is a strong relationship between land use and zoning. But that relationship is far from perfect, zoning is a funny
beast. For example, zoning laws prevent low-rise apartments to be built in areas zoned for single family housing. But
they permit single family housing in areas zoned for low-rise apartments. Or in areas zoned as commercial. The land
use dataset allows to tag every property based on what it is actually used for.</p>

<p>Of course the land use dataset is not perfect and has some issues, but overall it gives a far superior view on how land
is used when compared to soley relying on zoning. But putting the two datasets together one can even further filter down
to tease out actual land use.</p>

<h3>The Forgotten Single Family Houses</h3>

<p>Single family houses have received a lot of attention lately, not least because of the
<a href="http://doodles.mountainmath.ca/blog/2016/01/24/work-vs-twiddling-thumbs/">incredible gains in land value during the last year</a>.</p>

<p>But how to narrow down the assessed properties to only single family housing? The easiest way to do this is to use zoning
as a proxy, so <a href="https://mountainmath.ca/map/assessment?filter=rs">only use RS zoned properties</a>. But there are a number
of problems with that.</p>

<p><a href="https://mountainmath.ca/map/assessment?filter=rs_not_sfh&amp;layer=14"><img  src="http://doodles.mountainmath.ca/images/rs_not_sfh.png" style="width:50%;float:right;"></a>
Firstly, only filtering by zone will still include lots of unwanted properties like schools and parks. I used to filter out
parks using the City of Vancouver parks dataset, but it actually does not capture all parks. And then I filtered by area
to get rid of large properties that typically house schools or other institutions. But that keeps smaller institutions in
and throws larger single family houses out. Using the land use data we can better focus in on all the residential properties
in the single family housing zone. But even then, there are <a href="https://mountainmath.ca/map/assessment?filter=rs_not_sfh&amp;layer=14">1,255 residential properties in &lsquo;RS&rsquo; zoned areas that are
not single family houses</a>.</p>

<p><a href="https://mountainmath.ca/map/assessment?filter=sfh_not_rs&amp;layer=6"><img  src="http://doodles.mountainmath.ca/images/sfh_not_rs.png" style="width:50%;float:left;margin-right:10px;"></a>
Secondly, and probably more importantly, it misses
<a href="https://mountainmath.ca/map/assessment?filter=sfh_not_rs&amp;layer=6">the 15% (12,111 total) of the single family stock that is situated in other zones</a>.
&lsquo;Upzoning&rsquo; a neighbourhood
only means that other forms of housing are also permitted, but people can still build single family homes there if they
would like.
<a href="https://mountainmath.ca/map/assessment?filter=sfh_not_rs&amp;layer=6">Zoom into the map</a> and choose different ways to colour
the properties if you want to learn more about where they are.</p>

<h3>All Single Family Houses</h3>

<p><a href="https://mountainmath.ca/map/assessment?filter=sfh&amp;layer=9"><img  src="http://doodles.mountainmath.ca/images/sfh.png" style="width:50%;float:right;"></a>
When adding in the land use data we can filter by actual land use. That immediately takes care of parks and schools and other institutions,
and at the same time it allows to find all &ldquo;single family or duplex&rdquo; properties. That gets us closer to what we are looking
for, but it also includes duplexes. But those are easy to detect in the assessment dataset, they show up with two separate
tax bills. So combining the two we get the actual <a href="https://mountainmath.ca/map/assessment?filter=sfh&amp;layer=9">map of all single family homes</a>.</p>

<p>Are these really <em>all</em> single family homes? Not quite. There are some issues with the land use dataset that mis-classify
a couple of properties. In particular some RS lots without a house are classified as &lsquo;Undeveloped&rsquo;, and some are classfied as
&lsquo;Single Detached &amp; Duplex&rsquo;, probably depending on what was there around the time the data was collected. The correct classification really
depends on what one is interested in, and will likely be outdated fast.</p>

<p>Moreover, the property assessment dataset of the City of Vancouver is to correctly link a couple of hundred properties
to their tax data. This won&rsquo;t be an issue when analysing the tax data, but it does cause a problem when mapping the properties
as they won&rsquo;t have any assessment or zoning data associated with them.</p>

<p>And there are issues on the fringes. Some properties in Southlands are used as single family homes on large lots, rather
than the limited agricultural that it is zoned at and labeled as in the land use dataset.</p>

<p>But overall, adding in the land
use information gives a huge improvement on narrowing down single family homes. We should remember that
&ldquo;single family homes&rdquo; are better described as &ldquo;single owner properties that can&rsquo;t be stratified&rdquo;,
as they may include secondary suites and laneway houses.</p>

<h3>Historical Data</h3>

<p>One shortcoming of the land use dataset is that there are no historic versions available. It would be very nice to be able
to see how land use changed over time, but that dataset won&rsquo;t do the trick. The City of Vancouver assessment dataset
comes with historic data all the way up to 2006, and can be used to do some fun
<a href="http://doodles.mountainmath.ca/blog/2016/01/18/redevelopment/">analysis</a>. But the historic dataset is incomlete in that
zoning information is only available from 2014 forward and in that historic property tax data can&rsquo;t always be linked to
physical properties if the property has been re-developed. But overall putting the datasets together allows to refine
the analysis previously made. For example re-running the <a href="http://doodles.mountainmath.ca/blog/2016/01/24/work-vs-twiddling-thumbs/">thumb twiddling rates</a>
using only Single Family Homes, we get pretty much the same medians, but the averages are higher. We could also refine
our <a href="http://doodles.mountainmath.ca/blog/2016/01/18/redevelopment/">teardown analysis</a> to include only single family homes
and better filter out institutional properties, although some issues with the lack of historic data remain.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Work vs Twiddling Thumbs]]></title>
    <link href="http://doodles.mountainmath.ca/blog/2016/01/24/work-vs-twiddling-thumbs/"/>
    <updated>2016-01-24T10:28:37-08:00</updated>
    <id>http://doodles.mountainmath.ca/blog/2016/01/24/work-vs-twiddling-thumbs</id>
    <content type="html"><![CDATA[<p><a href="http://www.mountainmath.ca/map/assessment?zoom=14&amp;lat=49.253&amp;lng=-123.1244&amp;layer=12"><img  src="http://doodles.mountainmath.ca/images/twiddling_thumbs.png" style="width:50%;float:left;margin-right:10px;"></a>In
the ongoing debade on affordability of housing in the City of Vancouver we regularly hear voices expressing concern for
&ldquo;<a href="http://news.nationalpost.com/full-comment/andrew-coyne-dont-blame-chinese-billionaires-for-vancouver-housing-prices">elderly folks of modest means who had been counting on using their home as a pension</a>&rdquo;
to argue against doing anything to ease the housing affordability problems many (younger) people are facing. In these
arguments the concern for &ldquo;elderly folks of modest means&rdquo; seems curiously focused to those who own property as opposed to,
for example, the 20% of the elderly people in Vancouver that live in poverty (15k total).</p>

<p>Which got me a little thinking about &ldquo;earning money&rdquo; in this day and age.</p>

<h3>Work</h3>

<!-- more -->


<p>Most people earn money by working. We are interested in after tax household income, for simplicity we will look at 2010 income
data reported in the 2011 census. The median after-tax household income in Vancouver
was $50k (the average was $65k), although there is <a href="http://censusmapper.ca/maps/224">large regional variability</a>.
The pre-tax households incomes were $56k for the median
and $80k for the average income.</p>

<p>Incomes have grown a bit since then, median income levels in
Vancouver grew by 7% from 2010 to 2013 (<a href="http://www5.statcan.gc.ca/cansim/a47">the latest year Stats Canada reports on</a>)
and will have grown a little more since then, but these are relatively small changes compared to other numbers I want
to talk about.</p>

<p><a href="http://censusmapper.ca/maps/189">Most of this income stems from employment income</a> which also includes self-employment,
but 22% of pre-tax income in Vancouver
came from outher sources, mostly investment income but also government transfer payments like child benefits.</p>

<p>Cumulative, the after tax income put $17.8bn into Vancouverite&rsquo;s pockets.</p>

<h3>Twiddling Thumbs</h3>

<p>Let&rsquo;s compare this to how much Vancouver home owner households earned last year by twiddling thumbs. Let&rsquo;s do a simple
calculation and focus on RS (&ldquo;One Family Dwelling&rdquo; zone) homes. We
will consider the change in land value only, changing the building value because of renovation or rebuilding certainly
does not happen by twiddling thumbs. And we will divide the land value rise of each property by the number of owners,
for RS that evenly divides up the land value increase between strata or duplex households that managed to sneak into the RS zoning.</p>

<p>The typical RS household made $267,000 last year (so that&rsquo;s the median land value rise in RS between 2015 and 2016
property tax assessment years, the average was $331,043), for a tity toal of $28,789,790,980. Not too shabby.
And considering that the typical owner household
lives in their home, these are tax-free earnings once the owners sell. That&rsquo;s substantially more than what the typical household
in Vancouver takes home. The total land value increase for just the RS zone properties amounts to $22.2bn out of
<a href="http://doodles.mountainmath.ca/blog/2016/01/17/updated-vancouver-assessment-data/">the $45.2bn by which land values in Vancouver increased overall</a>. For context,
recall that the overall income earned by all Vancouverites in 2010 was $17.8bn after tax (21.3bn before tax).</p>

<p>In other words, just the RS property owners earned more by twiddling their tumbs than the entire population of the
City of Vancouver did by &ndash; actually working. Yet another
indication of how <a href="http://censusmapper.ca/maps/37">out of touch the property market is with the local enconomy</a>.</p>

<h3>Mappig the Result of Thumb Twiddling</h3>

<p><a href="http://www.mountainmath.ca/map/assessment?zoom=14&amp;lat=49.253&amp;lng=-123.1244&amp;layer=12">There is a map for this</a>. (I probably would not take the time to write about this otherwise.) Last year&rsquo;s assessment
increase was quite large, not every year is like this (although it looks like the coming one will also be substantial).
To even things out a little I mapped the average yearly gross land value increase for each property. And for good measure I, divided
by the number of households for strata, duplex and other properties that are tied to several owners. For properties that I
could not trace back all the way to 2006 I averaged over as many years as I could find.</p>

<p><a href="http://www.mountainmath.ca/map/assessment?zoom=14&amp;lat=49.253&amp;lng=-123.1244&amp;layer=12"><img  src="http://doodles.mountainmath.ca/images/twiddling_thumbs.png" style="width:50%;float:right;"></a>
<a href="http://www.mountainmath.ca/map/assessment?zoom=14&amp;lat=49.253&amp;lng=-123.1244&amp;layer=12">Looking at the map</a> we see that
the average yearly increase depends to a large extend on the square footage of the property. Large properties naturally stand
out, unless they are stratified where the land value increase gets distributed across all the owners.</p>

<p>Averaged over 10 years, the yearly land value increase for the typical RS property in Vancouver was $82,700. Using Main as
a divider the numbers are $66,600 for the
typical east of Main and $145,100 for the typical west of Main property (using median increases). The average increases were $117,334 city wide,
$73,294 east and $175,773 west of Main.</p>

<p>A good portion of the east-west difference is due to larger lot size, but even the land values increase per m&sup2; for properties
on the west side was 35% higher than that of properties on the
east side. These are yearly increases, to be accumulated and collected tax free in most cases when the property is sold.</p>

<h3>Hourly Rate for Twiddling Thumbs</h3>

<p>Just for fun we can work out the hourly rate for twiddling thumbs. All we need to do is divide by the number of work
hours by year. We can look up the average work weeks for a Vancouver worker in the 2011 census and, for style points also consider the
number of household maintainers. After all, when we compare household income with land value increases we should consider how many
people in the household work. 63% of Vancouver households have only one household maintainer, but
<a href="http://censusmapper.ca/maps/223">33% have two and 4% three or more household maintainers</a> contributing to household income.
On average a Vancouver household <a href="http://censusmapper.ca/maps/222">worked a total of 62 person-weeks per year</a> to earn
that income. Assuming a 40 hour work week, we compute the average after-tax earning to be $26 per hour from regular work
and average after tax earnings of $113 per hour from twiddling thumbs. That&rsquo;s assuming all household maintainers are twiddling
the same amount of time that they dedicate to regular work. (In this calculation we use average not median income and land value
increases, medians don&rsquo;t lend themselves well to these kind of reasoning.)</p>

<p>Using the 10 year averaged numbers instead of focusing on just the last year we still get a healthy average after-tax twiddling thumbs rate of $47 per hour.</p>

<p>I am not entirely sure why anyone would want twiddling thumbs to stay so lucrative. Unless maybe the super self-centered thumb-twiddlers.
Or why earnings from thumb-twiddling should remain tax-free. While employment income is taxed (as it should be).</p>

<p>Considering to change your line work to thumb twiddling? To bad thumb twiddling is so unaffordable!</p>

<h2>Update</h2>

<p><a href="http://www.mountainmath.ca/map/special/34?layer=12"><img  src="http://doodles.mountainmath.ca/images/RS_original.png" style="width:50%;float:right;"></a>
I got some good feedback on the post so I decided to clear some things up and re-run the analysis with some small changes.</p>

<p>Linking a map of all properties when the analysis was only done on RS properties was a little confusing. So I added a map
<a href="http://www.mountainmath.ca/map/special/34?layer=12">of all RS zoned properties only</a> that the analysis was based on.</p>

<p>Some people correctly pointed out that there are some schools and other large properties that are RS zone but probably
should not be included in the analysis. So I decided to quickly re-run the analysis where I excluded properties with
area larger than 10,000m&amp;sup2. The cutoff is somewhat arbitrary, but it seemed about right so that schools and other large
properties are excluded, but most large single family lots are still included. The filter is not perfect, but probably
better than running the analysis without the filter. Here is the raw output with the area cutoff:</p>

<h5>Land Value Rise in RS (2015 - 2016)</h5>

<ul>
<li>City Wide: Average $318,877 Median $267,000, Count: 67269, Total: $21,450,566,401, Hourly: $128</li>
<li>East of Main: Average $235,871 Median $231,000, Count: 38319, Total: $9,038,373,901, Hourly: $95</li>
<li>West of Main: Average $428,745 Median $381,000, Count: 28950, Total: $12,412,192,500, Hourly: $172</li>
</ul>


<p>As expected, the area cutoff had almost no effect on the median, but did push the average down a bit.</p>

<p><a href="http://www.mountainmath.ca/map/special/37?layer=12"><img  src="http://doodles.mountainmath.ca/images/RS.png" style="width:50%;float:left;margin-right:10px;"></a>
The map shows the average increases over a 10 year timeframe, here are the numbers with the <a href="http://www.mountainmath.ca/map/special/37?layer=12">larger properties exluded</a>:</p>

<ul>
<li>City Wide: Average $112,588 Median $82,500, Count: 66556, Total: $7,493,456,449, Hourly: $45</li>
<li>East of Main: Average $70,109 Median $66,600, Count: 37960, Total: $2,661,346,243, Hourly: $28</li>
<li>West of Main: Average $168,978 Median $145,100, Count: 28596, Total: $4,832,110,206, Hourly: $68</li>
</ul>


<p>Also, I decided to do another run of the analysis including RT and RM zones (Two and Multiple Family Dwelling) next to RS (One Family Dwelling),
as well as Shaugnessy&rsquo;s FSD zone. Things get a little tricky in RT and RM. There are many single family properties in these
zones, so for those things work as expected. Then there are stratified properties, and we divide by the number of owners
to split up the land value rise. And there are larger rental buildings where the owner takes the entire land value increase.</p>

<p>Here is the raw output of the analysis:</p>

<h5>Land Value Rise in RS, RT, RM and FSD (2015 - 2016)</h5>

<ul>
<li>City Wide: Average $336,504 Median $265,000, Count: $84683, Total: $28,496,185,854, Hourly: $135</li>
<li>East of Main: Average $239,916 Median $230,000, Count: $47893, Total: $11,490,308,602, Hourly: $96</li>
<li>West of Main: Average $462,241 Median $375,000, Count: $36790, Total: $17,005,877,252, Hourly: $186</li>
</ul>


<p>To round things up, here are the numbers for RS, RT, RM and FSD zones averaged over 10 years:</p>

<h5>Land Value Rise in RS, RT, RM and FSD (2006 - 2016)</h5>

<p><a href="http://www.mountainmath.ca/map/special/36?layer=12"><img  src="http://doodles.mountainmath.ca/images/RS+RT+RM+FSD.png" style="width:50%;float:right;"></a></p>

<p>City Wide: Average $119,596 Median $83,000, Count: 83479, Total: $9,983,800,611, Hourly: $48
East of Main: Average $72,767 Median $67,200, Count: 47254, Total: $3,438,565,286, Hourly: $29
West of Main: Average $180,682 Median $143,600, Count: 36225, Total: $6,545,235,325, Hourly: $72</p>

<p>And for good measure, <a href="http://www.mountainmath.ca/map/special/36?layer=12">here is the map for the properties included in the last analysis</a>.</p>

<h2>Later update</h2>

<p>After importing the <a href="http://doodles.mountainmath.ca/blog/2016/01/31/land-use/">Metro Vancouver land use data</a> we can
now pinpoint all Single Familiy Dwellings and don&rsquo;t have to use zoning as a proxy. Here are the numbers when running them
only on all of City of Vancouver&rsquo;s 78,740 Single Family Dwellings:</p>

<h5>SFH Land Value Rise (2015 - 2016)</h5>

<ul>
<li>City Wide: Average $313,072 Median $262,000, Count: 78740, Total: $24,651,312,001, Hourly: $126</li>
<li>East of Main: Average $230,106 Median $230,000, Count: 46014, Total: $10,588,122,001, Hourly: $92</li>
<li>West of Main: Average $429,725 Median $375,000, Count: 32726, Total: $14,063,190,000, Hourly: $173</li>
</ul>


<h5>SFH Land Value Rise (2006 - 2016)</h5>

<ul>
<li>City Wide: Average $109,969 Median $79,800, Count: 77981, Total: $8,575,547,711, Hourly: $44</li>
<li>East of Main: Average $68,656 Median $66,700, Count: 45647, Total: $3,133,947,703, Hourly: $27</li>
<li>West of Main: Average $168,293 Median $141,700, Count: 32334, Total: $5,441,600,008, Hourly: $67</li>
</ul>


<p>The total number of units for the 2006 to 2016 analysis are a little lower since not all properties can be traced over that time
period without resorting to more tedious analysis.</p>

<p>And <a href="https://mountainmath.ca/map/assessment?filter=sfh&amp;layer=12">here is the obligatory map for the properties included in the last analysis</a>.</p>
]]></content>
  </entry>
  
</feed>
